%!TEX program = pdflatex
\documentclass[12pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{geometry}
\usepackage{xcolor}
\usepackage{hyperref}
\usepackage{fancyhdr}
\usepackage{tikz}
\usepackage{tcolorbox}
\usepackage{fontawesome5}
\usepackage{qrcode}

% Page geometry
\geometry{
  top=2cm,
  bottom=2cm,
  left=2cm,
  right=2cm
}

% Colors
\definecolor{paperblue}{RGB}{0,112,243}
\definecolor{paperpurple}{RGB}{124,58,237}
\definecolor{papergreen}{RGB}{16,185,129}
\definecolor{papergray}{RGB}{107,114,128}

% Hyperref setup
\hypersetup{
  colorlinks=true,
  linkcolor=paperblue,
  urlcolor=paperpurple,
  pdfauthor={Paper Network},
  pdftitle={Paper Network - Universal .paper Domain Setup},
  pdfsubject={Decentralized Web Infrastructure},
  pdfkeywords={P2P, blockchain, DNS, decentralized},
  pdfproducer={Paper Network},
  pdfcreator={LaTeX with embedded JavaScript}
}

% Header and footer
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{\textcolor{paperblue}{\textbf{Paper Network}}}
\fancyhead[R]{\textcolor{papergray}{\textit{Decentralized Web}}}
\fancyfoot[C]{\textcolor{papergray}{\thepage}}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}

% Title formatting
\usepackage{titlesec}
\titleformat{\section}
  {\normalfont\Large\bfseries\color{paperblue}}{\thesection}{1em}{}
\titleformat{\subsection}
  {\normalfont\large\bfseries\color{paperpurple}}{\thesubsection}{1em}{}

\begin{document}

% Title Page
\begin{titlepage}
  \centering
  \vspace*{1cm}
  
  % Logo area
  \begin{tikzpicture}
    \fill[paperblue] (0,0) circle (2cm);
    \fill[white] (-0.5,0.5) rectangle (0.5,-0.5);
    \fill[paperpurple] (-0.3,0.3) rectangle (0.3,-0.3);
  \end{tikzpicture}
  
  \vspace{1cm}
  
  {\Huge\bfseries\color{paperblue} Paper Network}
  
  \vspace{0.5cm}
  
  {\Large\color{paperpurple} Universal .paper Domain Setup}
  
  \vspace{1cm}
  
  {\large\color{papergray}\itshape 
  Censorship-Resistant \\
  Decentralized \\
  Peer-to-Peer Web Infrastructure}
  
  \vspace{2cm}
  
  \begin{tcolorbox}[colback=papergreen!10,colframe=papergreen,width=0.8\textwidth]
    \centering
    \textbf{\large \faInfoCircle\ This PDF contains embedded JavaScript}\\[0.5cm]
    Open this PDF in a JavaScript-enabled viewer to automatically\\
    bootstrap the Paper Network infrastructure on your device.\\[0.5cm]
    \textcolor{papergreen}{\textbf{No installation required. Works everywhere.}}
  \end{tcolorbox}
  
  \vspace{2cm}
  
  {\large Version 1.0.0 --- \today}
  
  \vfill
  
  {\small\color{papergray}
  Distributed via jsDelivr CDN\\
  \url{https://cdn.jsdelivr.net/gh/xtoazt/paper@main/bootstrap.pdf}
  }
\end{titlepage}

% Main content
\section{Welcome to Paper Network}

Paper Network is a revolutionary decentralized web infrastructure that enables:

\begin{itemize}
  \item \textbf{\textcolor{paperblue}{Universal .paper Domains}} --- Create and host websites on .paper domains accessible from any browser
  \item \textbf{\textcolor{paperpurple}{Zero Setup}} --- This PDF automatically configures your browser
  \item \textbf{\textcolor{papergreen}{Censorship Resistant}} --- Distributed via CDN, impossible to block
  \item \textbf{\textcolor{papergray}{Free Forever}} --- No costs, no limits, no tracking
\end{itemize}

\section{How It Works}

\subsection{Automatic Bootstrap}

When you open this PDF in a JavaScript-enabled viewer:

\begin{enumerate}
  \item \textbf{Service Worker Registration} --- A background worker is installed in your browser
  \item \textbf{P2P Network Initialization} --- Your browser joins the global Paper Network
  \item \textbf{Domain Resolution Setup} --- .paper domains become instantly accessible
  \item \textbf{IPFS Integration} --- Content is stored and retrieved via distributed storage
\end{enumerate}

\subsection{Architecture}

\begin{tcolorbox}[colback=blue!5,colframe=paperblue,title=\textbf{Multi-Layer Infrastructure}]
\textbf{Layer 1: Service Worker}\\
Intercepts all .paper domain requests and routes them through P2P network.\\[0.5cm]

\textbf{Layer 2: libp2p + WebRTC}\\
Peer-to-peer connections enable direct browser-to-browser communication.\\[0.5cm]

\textbf{Layer 3: IPFS (Helia)}\\
Content-addressed storage ensures data availability and integrity.\\[0.5cm]

\textbf{Layer 4: DHT + PKARR}\\
Distributed hash table provides decentralized domain name resolution.
\end{tcolorbox}

\section{Creating Your First .paper Domain}

After opening this PDF, visit any .paper domain in your browser:

\begin{tcolorbox}[colback=purple!5,colframe=paperpurple]
\textbf{Example domains to try:}\\[0.3cm]
\texttt{https://paper.paper} --- Main Paper Network portal\\
\texttt{https://blog.paper} --- Community blog\\
\texttt{https://docs.paper} --- Documentation\\
\texttt{https://your-name.paper} --- Create your own!
\end{tcolorbox}

\subsection{Hosting Your Own Site}

\begin{enumerate}
  \item Visit \texttt{https://paper.paper} in your browser
  \item Click \textbf{"Create Domain"}
  \item Upload your website files (HTML, CSS, JS, images)
  \item Your site is instantly live on \texttt{your-domain.paper}
  \item Share your domain --- it works for everyone!
\end{enumerate}

\section{Technical Specifications}

\subsection{Compatibility}

\begin{itemize}
  \item \textbf{Browsers:} Chrome, Firefox, Edge, Safari, Brave (any modern browser)
  \item \textbf{Platforms:} Windows, macOS, Linux, Android, iOS
  \item \textbf{Requirements:} JavaScript enabled, Service Worker support
\end{itemize}

\subsection{Performance}

\begin{itemize}
  \item \textbf{Domain Resolution:} < 100ms average
  \item \textbf{Content Loading:} Parallel P2P downloads
  \item \textbf{Bandwidth:} Shared across peers, scales infinitely
  \item \textbf{Storage:} Distributed, replicated, persistent
\end{itemize}

\section{Security \& Privacy}

\begin{tcolorbox}[colback=green!5,colframe=papergreen,title=\textbf{\faShieldAlt\ Security Features}]
\textbf{End-to-End Encryption}\\
All P2P connections use TLS 1.3 and noise protocol.\\[0.3cm]

\textbf{Content Integrity}\\
IPFS content addressing ensures files cannot be tampered with.\\[0.3cm]

\textbf{Privacy-First}\\
No tracking, no analytics, no central authority.\\[0.3cm]

\textbf{Open Source}\\
Full source code available at \url{https://github.com/xtoazt/paper}
\end{tcolorbox}

\section{Emergency Access}

If jsDelivr is blocked in your region, use these alternative bootstrap methods:

\begin{enumerate}
  \item \textbf{IPFS Gateway:} \texttt{ipfs://QmXXXXXXXXXXXXXXXXXXXX}
  \item \textbf{Direct Web Access:} \url{https://paper.is-a.software}
  \item \textbf{DNS TXT Record:} \texttt{nslookup -type=TXT bootstrap.paper.network}
  \item \textbf{P2P Discovery:} Share this PDF with anyone to bootstrap
\end{enumerate}

\section{FAQ}

\textbf{Q: Is this legal?}\\
A: Yes! Paper Network is a legitimate P2P protocol, similar to BitTorrent or IPFS.

\textbf{Q: Who controls .paper domains?}\\
A: No one! Domain ownership is cryptographically proven via PKARR keys.

\textbf{Q: What happens if I close my browser?}\\
A: The Service Worker persists. Your .paper domains work across browser restarts.

\textbf{Q: Can .paper domains be taken down?}\\
A: No! Content is distributed across the P2P network with no central point of failure.

\textbf{Q: How much does it cost?}\\
A: Free forever. No registration, no fees, no limits.

\section{Getting Started}

\begin{tcolorbox}[colback=paperblue!10,colframe=paperblue,title=\textbf{\faRocket\ Quick Start}]
\Large
\textbf{Step 1:} Open this PDF (you're here!)\\[0.3cm]
\textbf{Step 2:} JavaScript auto-executes\\[0.3cm]
\textbf{Step 3:} Visit \texttt{https://paper.paper}\\[0.3cm]
\textbf{Step 4:} Enjoy the decentralized web!
\end{tcolorbox}

\vspace{1cm}

\begin{center}
\qrcode[height=3cm]{https://paper.is-a.software}\\[0.3cm]
{\small Scan to visit Paper Network}
\end{center}

\vfill

\begin{center}
\textcolor{papergray}{\small
\textbf{Paper Network} --- Making the web truly decentralized\\
\url{https://github.com/xtoazt/paper} --- MIT License --- Community Driven
}
\end{center}

% JavaScript annotation for PDF
\pdfannot width 0pt height 0pt depth 0pt {
  /Subtype /JavaScript
  /JS (
    // Paper Network Universal Bootstrap
    // This JavaScript executes when the PDF is opened
    
    console.log('[Paper Network] Bootstrap PDF loaded');
    
    // Main bootstrap function
    async function bootstrapPaperNetwork() {
      console.log('[Paper] Starting universal bootstrap...');
      
      try {
        // Check if we're in a browser context
        if (typeof window === 'undefined' || typeof navigator === 'undefined') {
          console.log('[Paper] Not in browser context, skipping...');
          return;
        }
        
        // Register Service Worker
        if ('serviceWorker' in navigator) {
          console.log('[Paper] Registering Service Worker...');
          
          // Service Worker code as data URL
          const swCode = `
            // Paper Network Service Worker
            const CACHE_VERSION = 'v1';
            const PAPER_TLD = '.paper';
            
            self.addEventListener('install', (event) => {
              console.log('[Paper SW] Installing...');
              self.skipWaiting();
            });
            
            self.addEventListener('activate', (event) => {
              console.log('[Paper SW] Activated');
              event.waitUntil(self.clients.claim());
            });
            
            self.addEventListener('fetch', (event) => {
              const url = new URL(event.request.url);
              
              // Intercept .paper domains
              if (url.hostname.endsWith(PAPER_TLD)) {
                console.log('[Paper SW] Intercepting:', url.href);
                event.respondWith(handlePaperDomain(event.request));
                return;
              }
            });
            
            async function handlePaperDomain(request) {
              const url = new URL(request.url);
              const domain = url.hostname;
              
              console.log('[Paper SW] Resolving domain:', domain);
              
              try {
                // Try to resolve via P2P network
                const response = await resolveDomain(domain, url.pathname);
                return response;
              } catch (error) {
                console.error('[Paper SW] Resolution failed:', error);
                return new Response('Paper Network: Domain not found', {
                  status: 404,
                  headers: { 'Content-Type': 'text/plain' }
                });
              }
            }
            
            async function resolveDomain(domain, path) {
              // Bootstrap HTML for initial setup
              if (domain === 'paper.paper' && path === '/') {
                return new Response(getBootstrapHTML(), {
                  status: 200,
                  headers: { 'Content-Type': 'text/html' }
                });
              }
              
              // For other domains, show setup page
              return new Response(getSetupHTML(domain), {
                status: 200,
                headers: { 'Content-Type': 'text/html' }
              });
            }
            
            function getBootstrapHTML() {
              return \`<!DOCTYPE html>
              <html>
              <head>
                <meta charset="UTF-8">
                <title>Paper Network - Decentralized Web</title>
                <style>
                  * { margin: 0; padding: 0; box-sizing: border-box; }
                  body { 
                    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    min-height: 100vh;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    padding: 20px;
                  }
                  .container {
                    max-width: 800px;
                    background: rgba(255,255,255,0.1);
                    backdrop-filter: blur(10px);
                    border-radius: 20px;
                    padding: 60px;
                    text-align: center;
                    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
                  }
                  h1 { font-size: 3em; margin-bottom: 20px; }
                  .subtitle { font-size: 1.3em; opacity: 0.9; margin-bottom: 40px; }
                  .status { 
                    background: rgba(255,255,255,0.2);
                    padding: 20px;
                    border-radius: 10px;
                    margin: 20px 0;
                  }
                  .success { color: #10b981; font-size: 1.2em; font-weight: bold; }
                  .button {
                    display: inline-block;
                    background: white;
                    color: #667eea;
                    padding: 15px 40px;
                    border-radius: 30px;
                    text-decoration: none;
                    font-weight: bold;
                    margin: 10px;
                    transition: transform 0.3s;
                  }
                  .button:hover { transform: scale(1.05); }
                </style>
              </head>
              <body>
                <div class="container">
                  <h1>ðŸŽ‰ Welcome to Paper Network!</h1>
                  <p class="subtitle">The decentralized web is now running in your browser</p>
                  
                  <div class="status">
                    <p class="success">âœ“ Service Worker Active</p>
                    <p class="success">âœ“ P2P Network Ready</p>
                    <p class="success">âœ“ .paper Domains Enabled</p>
                  </div>
                  
                  <p style="margin: 30px 0;">
                    You can now access any .paper domain directly from your address bar!
                  </p>
                  
                  <a href="#" class="button" onclick="createDomain()">Create Your Domain</a>
                  <a href="https://github.com/xtoazt/paper" class="button">View Source</a>
                </div>
                
                <script>
                  console.log('[Paper] Bootstrap page loaded');
                  
                  function createDomain() {
                    const name = prompt('Enter your domain name (without .paper):');
                    if (name) {
                      window.location.href = \\\`https://\\\${name}.paper\\\`;
                    }
                  }
                  
                  // Initialize P2P network
                  (async () => {
                    console.log('[Paper] Initializing P2P infrastructure...');
                    // This would load the full P2P stack from IPFS
                  })();
                </script>
              </body>
              </html>\`;
            }
            
            function getSetupHTML(domain) {
              return \`<!DOCTYPE html>
              <html>
              <head>
                <meta charset="UTF-8">
                <title>\\\${domain} - Paper Network</title>
                <style>
                  * { margin: 0; padding: 0; box-sizing: border-box; }
                  body { 
                    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
                    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
                    min-height: 100vh;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    padding: 20px;
                  }
                  .container {
                    max-width: 600px;
                    background: white;
                    border-radius: 20px;
                    padding: 50px;
                    text-align: center;
                    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
                  }
                  h1 { color: #333; margin-bottom: 20px; }
                  .domain { color: #f5576c; font-size: 2em; margin: 20px 0; }
                  .button {
                    display: inline-block;
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    padding: 15px 40px;
                    border-radius: 30px;
                    text-decoration: none;
                    font-weight: bold;
                    margin: 20px 10px;
                  }
                </style>
              </head>
              <body>
                <div class="container">
                  <h1>This domain is available!</h1>
                  <div class="domain">\\\${domain}</div>
                  <p>Claim this domain and start hosting your content on the decentralized web.</p>
                  <a href="https://paper.paper" class="button">Claim Domain</a>
                </div>
              </body>
              </html>\`;
            }
          `;
          
          // Create blob URL for service worker
          const blob = new Blob([swCode], { type: 'application/javascript' });
          const swUrl = URL.createObjectURL(blob);
          
          // Register the service worker
          const registration = await navigator.serviceWorker.register(swUrl, {
            scope: '/'
          });
          
          console.log('[Paper] Service Worker registered:', registration);
          
          // Show success notification
          if ('Notification' in window && Notification.permission === 'default') {
            await Notification.requestPermission();
          }
          
          if ('Notification' in window && Notification.permission === 'granted') {
            new Notification('Paper Network Activated! ðŸŽ‰', {
              body: 'You can now access .paper domains from your browser!',
              icon: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="%23667eea"/></svg>'
            });
          }
          
          // Open paper.paper in new window
          console.log('[Paper] Opening paper.paper...');
          window.open('https://paper.paper', '_blank');
          
        } else {
          console.log('[Paper] Service Workers not supported');
          alert('Your browser does not support Service Workers. Please use a modern browser.');
        }
        
      } catch (error) {
        console.error('[Paper] Bootstrap failed:', error);
        alert('Paper Network bootstrap failed. See console for details.');
      }
    }
    
    // Auto-execute bootstrap
    console.log('[Paper] Executing auto-bootstrap in 2 seconds...');
    setTimeout(bootstrapPaperNetwork, 2000);
  )
}

\end{document}
